# 立方体位姿输出规范

## 1. 坐标系定义

### 1.1 世界坐标系 (World Coordinate System)
- X轴: 指向相机1（12点方向）
- Y轴: 指向相机2（3点方向） 
- Z轴: 指向下方（桌面）


### 1.2 相机坐标系 (Camera Coordinate System)

#### 相机1坐标系
- Z轴: 指向观察目标（与世界-X轴同向）
- X轴: 向右（与世界-Y轴同向）
- Y轴: 向下（与世界Z轴同向）


#### 相机2坐标系
- Z轴: 指向观察目标（与世界-Y轴同向）
- X轴: 向右（与世界X轴同向）
- Y轴: 向下（与世界Z轴同向）

### 1.3 Marker坐标系
所有Marker坐标系均采用右手系：

1. Marker 1（前面）
- Z轴: 与世界+X同向
- X轴: 与世界-Y轴同向
- Y轴: 与世界-Z轴同向

2. Marker 3（后面）
- Z轴: 与世界-X轴同向
- X轴: 与世界+Y轴同向
- Y轴: 与世界-Z轴同向

3. Marker 5（右面）
- Z轴: 与世界-Y轴同向
- X轴: 与世界-X轴同向
- Y轴: 与世界-Z轴同向

4. Marker 7（左面）
- Z轴: 与世界+Y轴同向
- X轴: 与世界+X轴同向
- Y轴: 与世界-Z轴同向

5. Marker 9（底面）
- Z轴: 与世界+Z轴同向
- X轴: 与世界-Y轴同向
- Y轴: 与世界+X轴同向

## 2. 位姿输出定义

### 2.1 位置数据 (Position)
输出格式为(X, Y, Z),单位为毫米(mm),表示立方体中心在世界坐标系中的位置:

- X: 相机1方向的位移
- Y: 相机2方向的位移  
- Z: 竖直方向的位移

### 2.2 姿态数据 (Orientation)
输出格式为(Roll, Pitch, Yaw),单位为度(°),表示立方体相对于初始姿态的旋转角度:

- Roll: 绕X轴旋转角度
- Pitch: 绕Y轴旋转角度
- Yaw: 绕Z轴旋转角度

### 2.3 标准化处理
- 角度值标准化到[-180°, 180°]范围内
- 位置值保留小数点后2位
- 角度值保留小数点后2位

## 3. 初始姿态定义

立方体初始姿态为:
- 立方体中心位于世界坐标系原点
- Marker 1 面向+X方向（面向相机1）
- Marker 7 面向+Y方向（面向相机2）
- Marker 9 面向+Z方向（面向桌面）

## 4. 数据融合规则

### 4.1 位置融合
- X值: 优先采用相机2数据
- Y值: 优先采用相机1数据
- Z值: 取两个相机测量值的平均值


### 4.2 姿态融合
- 对于Roll、Pitch、Yaw各个角度：
  1. 将两个相机的测量值标准化到[-180°, 180°]范围
  2. 计算角度差并进行跨周期处理
  3. 取处理后的平均值作为最终结果


## 5. 输出示例

```plaintext
Fused Cube Pose:

Position (mm):
    X = 125.47 (get from Camera2)
    Y = -45.82 (get from Camera1)
    Z = 78.35 (averaged)

Rotation (deg):
    Roll = 15.72
    Pitch = -8.45
    Yaw = 178.93
```
